<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ãƒ“ã‚¸ãƒã‚¹ã‚¨ãƒ³ãƒ‘ã‚¤ã‚¢ - çµŒå–¶ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ç‰ˆï¼‰</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Hiragino Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .company-name { font-size: 22px; font-weight: bold; margin-bottom: 8px; }
        .date { font-size: 14px; opacity: 0.9; }
        .stats {
            display: flex;
            justify-content: space-around;
            padding: 15px;
            background: rgba(255,255,255,0.1);
        }
        .stat { text-align: center; }
        .stat-label { font-size: 12px; opacity: 0.8; margin-bottom: 4px; }
        .stat-value { font-size: 18px; font-weight: bold; }
        
        /* ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ†ã‚£ãƒƒã‚«ãƒ¼ */
        .news-ticker {
            background: #333;
            color: #ffd700;
            padding: 8px;
            overflow: hidden;
            white-space: nowrap;
            font-size: 12px;
        }
        .news-ticker span {
            display: inline-block;
            animation: scroll 20s linear infinite;
        }
        @keyframes scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        /* ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤º */
        .ranking-bar {
            background: #f0f0f0;
            padding: 10px;
            display: flex;
            justify-content: space-around;
            font-size: 11px;
        }
        .rank-item {
            text-align: center;
            padding: 5px;
            border-radius: 5px;
        }
        .rank-item.player { background: #ffd700; font-weight: bold; }
        
        .tabs {
            display: flex;
            padding: 15px 15px 0;
            gap: 10px;
            overflow-x: auto;
            background: white;
        }
        .tab {
            padding: 10px 15px;
            background: #f0f0f0;
            border: none;
            border-radius: 10px 10px 0 0;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .content {
            padding: 20px;
            min-height: 400px;
            background: white;
        }
        .panel { display: none; }
        .panel.active { display: block; }
        .btn {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }
        .btn:active { transform: scale(0.98); }
        .employee {
            background: #f8f8f8;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        .employee-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .employee-name { font-weight: bold; font-size: 16px; }
        .personality {
            background: #667eea;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
        }
        .abilities {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 10px 0;
        }
        .ability { font-size: 13px; }
        .ability-name { color: #666; }
        .ability-value { font-weight: bold; color: #333; }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 15px;
            max-width: 350px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal-title { font-size: 20px; font-weight: bold; margin-bottom: 15px; }
        .modal-close {
            width: 100%;
            padding: 12px;
            background: #e0e0e0;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            margin-top: 15px;
            cursor: pointer;
        }
        .empty { text-align: center; color: #999; padding: 40px 20px; }
        .product {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
        }
        .info-box {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .competitor {
            background: #fff3cd;
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            border-left: 3px solid #ff9800;
        }
        
        /* å®Ÿç¸¾è¡¨ç¤ºç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .achievement {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            border-left: 3px solid #ffa500;
        }
        
        .achievement-unlocked {
            animation: achievementPulse 2s ease-in-out;
        }
        
        @keyframes achievementPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="company-name">æ ªå¼ä¼šç¤¾ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—</div>
            <div class="date" id="gameDate">2025å¹´1æœˆ ç¬¬1é€±</div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">ğŸ’° è³‡é‡‘</div>
                    <div class="stat-value" id="money">1000ä¸‡</div>
                </div>
                <div class="stat">
                    <div class="stat-label">ğŸ‘¥ å¾“æ¥­å“¡</div>
                    <div class="stat-value" id="employeeCount">1</div>
                </div>
                <div class="stat">
                    <div class="stat-label">ğŸ“Š å£²ä¸Š</div>
                    <div class="stat-value" id="revenue">0ä¸‡</div>
                </div>
            </div>
        </div>

        <!-- ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ†ã‚£ãƒƒã‚«ãƒ¼ -->
        <div class="news-ticker">
            <span id="newsText">ğŸ“° ã‚²ãƒ¼ãƒ é–‹å§‹ï¼ITæ¥­ç•Œã§æˆåŠŸã‚’ç›®æŒ‡ãã†ï¼</span>
        </div>

        <!-- ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤º -->
        <div class="ranking-bar" id="rankingBar">
            <div class="rank-item">1ä½: ãƒ†ãƒƒã‚¯ã‚³ãƒ¼ãƒ—(35%)</div>
            <div class="rank-item">2ä½: ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ¯ãƒ¼ã‚¯ã‚¹(29%)</div>
            <div class="rank-item">3ä½: ã‚µã‚¤ãƒãƒ¼ã‚½ãƒ•ãƒˆ(22%)</div>
            <div class="rank-item player">4ä½: ã‚ãªãŸ(0.1%)</div>
        </div>

        <div class="tabs">
            <button class="tab active" data-panel="overview">ğŸ“Š æ¦‚è¦</button>
            <button class="tab" data-panel="employees">ğŸ‘¥ äººäº‹</button>
            <button class="tab" data-panel="products">ğŸ“¦ è£½å“</button>
            <button class="tab" data-panel="market">ğŸ¢ å¸‚å ´</button>
            <button class="tab" data-panel="finance">ğŸ’° è²¡å‹™</button>
        </div>

        <div class="content">
            <div id="overview" class="panel active">
                <h3>ğŸ¢ ä¼šç¤¾æ¦‚è¦</h3>
                <div class="info-box">
                    <div>æ¥­ç•Œ: ITãƒ»ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</div>
                    <div>å¸‚å ´ã‚·ã‚§ã‚¢: <span id="marketShare">0.1%</span></div>
                    <div>ãƒ–ãƒ©ãƒ³ãƒ‰åŠ›: <span id="brand">â­</span></div>
                    <div>è©•åˆ¤: <span id="reputation">50</span>/100</div>
                    <div>å¸‚å ´ç’°å¢ƒ: <span id="marketTrend">å®‰å®š</span></div>
                    <div>ç ”ç©¶P: <span id="researchPoints">0</span></div>
                </div>
                
                <div id="strategyBox" class="info-box">
                    <h4>ğŸ¯ çµŒå–¶æˆ¦ç•¥</h4>
                    <div id="currentStrategy">æˆ¦ç•¥æœªè¨­å®š</div>
                    <button class="btn" onclick="showStrategySelection()" style="margin: 5px 0; padding: 10px; font-size: 14px;">æˆ¦ç•¥å¤‰æ›´</button>
                </div>
                
                <div id="achievementsList" class="info-box" style="display: none;">
                    <h4>ğŸ† ç²å¾—å®Ÿç¸¾</h4>
                    <div id="achievements"></div>
                </div>
                
                <button class="btn" onclick="nextTurn()">â­ï¸ æ¬¡ã®ã‚¿ãƒ¼ãƒ³ã¸</button>
                <button class="btn" onclick="saveGame()">ğŸ’¾ ã‚²ãƒ¼ãƒ ä¿å­˜</button>
                <button class="btn" onclick="showAchievements()">ğŸ† å®Ÿç¸¾ç¢ºèª</button>
            </div>

            <div id="employees" class="panel">
                <h3>ğŸ‘¥ å¾“æ¥­å“¡ç®¡ç†</h3>
                <div id="employeeList"></div>
                <button class="btn" onclick="showHiring()">â• æ¡ç”¨æ´»å‹•</button>
                <button class="btn" onclick="trainEmployees()">ğŸ“š ç ”ä¿®å®Ÿæ–½</button>
            </div>

            <div id="products" class="panel">
                <h3>ğŸ“¦ è£½å“é–‹ç™º</h3>
                <div id="productList"></div>
                <button class="btn" onclick="developProduct()">ğŸ”§ æ–°è£½å“é–‹ç™º</button>
            </div>

            <div id="market" class="panel">
                <h3>ğŸ¢ å¸‚å ´çŠ¶æ³</h3>
                <div id="marketInfo"></div>
                <button class="btn" onclick="doMarketing()">ğŸ“¢ ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</button>
            </div>

            <div id="finance" class="panel">
                <h3>ğŸ’° è²¡å‹™çŠ¶æ³</h3>
                <div id="financeInfo"></div>
                <button class="btn" onclick="getLoan()">ğŸ¦ éŠ€è¡Œèè³‡</button>
            </div>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-title" id="modalTitle"></div>
            <div id="modalBody"></div>
            <button class="modal-close">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <!-- JavaScript ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ -->
    <script src="js/game-constants.js"></script>
    <script src="js/game-data.js"></script>
    <script src="js/game-models.js"></script>
    <script src="js/business-game.js"></script>
    <script src="js/game-ui.js"></script>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        let businessGame;
        
        /**
         * ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
         */
        function initGame() {
            try {
                businessGame = new BusinessGame();
                gameUI = new GameUI(businessGame);
                
                gameUI.updateDisplay();
                gameUI.updateRanking();
                gameUI.generateNews();
                
                console.log('ã‚²ãƒ¼ãƒ åˆæœŸåŒ–å®Œäº†');
            } catch (error) {
                console.error('ã‚²ãƒ¼ãƒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                alert('ã‚²ãƒ¼ãƒ ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
            }
        }

        /**
         * ã‚²ãƒ¼ãƒ æ“ä½œã®äº’æ›æ€§é–¢æ•°ç¾¤
         */
        function nextTurn() {
            const result = gameUI.executeGameAction('nextTurn');
            if (result.success && businessGame.week === 1) {
                // æœˆæ¬¡å‡¦ç†ã®å ´åˆã¯è¿½åŠ æƒ…å ±ã‚’è¡¨ç¤º
                gameUI.generateNews();
                
                // æœˆæ¬¡æ±ºç®—æƒ…å ±ã‚’å–å¾—ã—ã¦è¡¨ç¤º
                const state = businessGame.getGameState();
                const salaryTotal = state.employees.reduce((sum, emp) => sum + emp.salary, 0);
                const profit = state.monthlyRevenue - salaryTotal;
                
                let statusMessage = `å£²ä¸Š: ${GameUtils.formatMoney(state.monthlyRevenue)}ä¸‡å††\n`;
                statusMessage += `çµŒè²»: ${GameUtils.formatMoney(salaryTotal)}ä¸‡å††\n`;
                statusMessage += `åˆ©ç›Š: ${GameUtils.formatMoney(profit)}ä¸‡å††`;
                
                gameUI.showNotification('æœˆæ¬¡æ±ºç®—', statusMessage, 'info');
            }
        }

        function showHiring() {
            const candidate = businessGame.generateCandidate();
            const totalCost = candidate.salary * GAME_CONSTANTS.COSTS.HIRING_MULTIPLIER;
            
            let traitsHtml = '';
            if (candidate.traits && candidate.traits.length > 0) {
                traitsHtml = `<div style="margin: 10px 0;">
                    <strong>ç‰¹æ€§:</strong><br>
                    ${candidate.traits.map(t => {
                        const trait = EMPLOYEE_TRAITS[t];
                        return trait ? `<span style="background: #667eea; color: white; padding: 2px 6px; border-radius: 3px; font-size: 11px; margin: 2px;">${trait.name}</span>` : '';
                    }).join(' ')}
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        ${candidate.traits.map(t => EMPLOYEE_TRAITS[t]?.description || '').join('<br>')}
                    </div>
                </div>`;
            }
            
            const html = `
                <div>å€™è£œè€…: ${candidate.name}</div>
                <div>æ€§æ ¼: ${candidate.personality}</div>
                <div>æŠ€è¡“: ${candidate.abilities.technical}</div>
                <div>å–¶æ¥­: ${candidate.abilities.sales}</div>
                <div>å¸Œæœ›çµ¦ä¸: ${GameUtils.formatMoney(candidate.salary)}ä¸‡å††/æœˆ</div>
                ${traitsHtml}
                <button class="btn" onclick="hireEmployee()">æ¡ç”¨ã™ã‚‹ (${GameUtils.formatMoney(totalCost)}ä¸‡å††)</button>
            `;
            
            gameUI.currentCandidate = candidate;
            gameUI.showModal('æ¡ç”¨é¢æ¥', html);
        }

        function hireEmployee() {
            if (gameUI.currentCandidate) {
                const result = businessGame.hireEmployee();
                gameUI.closeModal();
                
                if (result.success) {
                    gameUI.showNotification('æ¡ç”¨æˆåŠŸ', `${result.employee.name}ã•ã‚“ã‚’æ¡ç”¨ã—ã¾ã—ãŸï¼`, 'success');
                    gameUI.updateDisplay();
                } else {
                    gameUI.showNotification('æ¡ç”¨å¤±æ•—', result.error, 'error');
                }
                
                gameUI.currentCandidate = null;
            }
        }

        function trainEmployees() {
            const result = gameUI.executeGameAction('trainEmployees');
            if (result.success) {
                gameUI.showNotification('ç ”ä¿®å®Œäº†', 
                    `å¾“æ¥­å“¡ã®ã‚¹ã‚­ãƒ«ãŒå‘ä¸Šã—ã¾ã—ãŸï¼\nè²»ç”¨: ${GameUtils.formatMoney(result.cost)}ä¸‡å††`, 
                    'success');
            }
        }

        function developProduct() {
            const result = gameUI.executeGameAction('developProduct');
            if (result.success) {
                gameUI.showNotification('é–‹ç™ºæˆåŠŸ', 
                    `${result.product.name}ã‚’é–‹ç™ºã—ã¾ã—ãŸï¼\nå“è³ª: ${result.product.quality}%`, 
                    'success');
            }
        }

        function doMarketing() {
            const result = gameUI.executeGameAction('doMarketing');
            if (result.success) {
                gameUI.showNotification('ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æˆåŠŸ', 'å¸‚å ´ã‚·ã‚§ã‚¢ã¨ãƒ–ãƒ©ãƒ³ãƒ‰åŠ›ãŒå‘ä¸Šï¼', 'success');
            }
        }

        function getLoan() {
            const result = gameUI.executeGameAction('getLoan');
            if (result.success) {
                gameUI.showNotification('èè³‡å®Ÿè¡Œ', 
                    `${GameUtils.formatMoney(result.amount)}ä¸‡å††ã®èè³‡ã‚’å—ã‘ã¾ã—ãŸ\nï¼ˆåˆ©æ¯è¾¼ã¿è¿”æ¸ˆé¡: 550ä¸‡å††ï¼‰`, 
                    'success');
            }
        }

        function saveGame() {
            const result = gameUI.executeGameAction('saveGame');
            if (result.success) {
                gameUI.showNotification('ä¿å­˜å®Œäº†', 'ã‚²ãƒ¼ãƒ ã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
            }
        }

        function showStrategySelection() {
            const strategiesHtml = Object.entries(COMPANY_STRATEGIES).map(([key, strategy]) => `
                <div style="margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 8px; ${businessGame.companyStrategy === key ? 'background: #e3f2fd;' : ''}">
                    <div style="font-weight: bold; margin-bottom: 5px;">${strategy.name}</div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 8px;">${strategy.description}</div>
                    <button class="btn" style="margin: 0; padding: 8px 16px; font-size: 12px;" onclick="selectStrategy('${key}')">${businessGame.companyStrategy === key ? 'é©ç”¨ä¸­' : 'é¸æŠ'}</button>
                </div>
            `).join('');
            
            gameUI.showModal('ğŸ¯ çµŒå–¶æˆ¦ç•¥é¸æŠ', `
                <div style="max-height: 350px; overflow-y: auto;">
                    ${strategiesHtml}
                    <div style="margin-top: 15px; padding: 10px; background: #f5f5f5; border-radius: 5px; font-size: 12px; color: #666;">
                        ğŸ’¡ æˆ¦ç•¥ã¯ä¼šç¤¾ã®é‹å–¶æ–¹é‡ã‚’æ±ºå®šã—ã€æ§˜ã€…ãªåŠ¹æœã«å½±éŸ¿ã—ã¾ã™ã€‚å¤‰æ›´ã¯æœˆåˆã«ã®ã¿å¯èƒ½ã§ã™ã€‚
                    </div>
                </div>
            `);
        }

        function selectStrategy(strategyKey) {
            const result = businessGame.selectStrategy(strategyKey);
            gameUI.closeModal();
            
            if (result.success) {
                gameUI.showNotification('æˆ¦ç•¥å¤‰æ›´å®Œäº†', 
                    `${result.strategy.name}ã‚’æ¡ç”¨ã—ã¾ã—ãŸï¼\n${result.strategy.description}`, 
                    'success');
                gameUI.updateDisplay();
            } else {
                gameUI.showNotification('å¤‰æ›´å¤±æ•—', result.error, 'error');
            }
        }

        function showAchievements() {
            const state = businessGame.getGameState();
            if (state.achievements.length === 0) {
                gameUI.showNotification('ğŸ† å®Ÿç¸¾', 'å®Ÿç¸¾ãŒã¾ã è§£é™¤ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚é ‘å¼µã£ã¦çµŒå–¶ã‚’æˆåŠŸã•ã›ã¾ã—ã‚‡ã†ï¼', 'info');
                return;
            }
            
            const achievedList = ACHIEVEMENTS
                .filter(a => state.achievements.includes(a.id))
                .map(a => `<div style="margin: 10px 0; padding: 10px; background: #f0f0f0; border-radius: 5px;">
                    <div style="font-weight: bold;">${a.name}</div>
                    <div style="color: #666; font-size: 14px;">${a.description}</div>
                </div>`)
                .join('');
                
            const unachievedList = ACHIEVEMENTS
                .filter(a => !state.achievements.includes(a.id))
                .map(a => `<div style="margin: 10px 0; padding: 10px; background: #f9f9f9; border-radius: 5px; opacity: 0.6;">
                    <div style="font-weight: bold;">ğŸ”’ ${a.name}</div>
                    <div style="color: #999; font-size: 14px;">${a.description}</div>
                </div>`)
                .join('');
            
            gameUI.showModal('ğŸ† å®Ÿç¸¾ä¸€è¦§', 
                `<div style="max-height: 300px; overflow-y: auto;">
                    <h4>âœ… ç²å¾—æ¸ˆã¿ (${state.achievements.length}/${ACHIEVEMENTS.length})</h4>
                    ${achievedList}
                    <h4 style="margin-top: 20px;">ğŸ¯ æœªç²å¾—</h4>
                    ${unachievedList}
                </div>`
            );
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', initGame);
        
        // ãƒ‡ãƒãƒƒã‚°ç”¨ï¼ˆé–‹ç™ºæ™‚ã®ã¿ä½¿ç”¨ï¼‰
        window.debugGame = {
            addMoney: (amount) => businessGame.money += amount,
            getState: () => businessGame.getGameState(),
            triggerEvent: (eventId) => {
                const event = RANDOM_EVENTS.find(e => e.id === eventId);
                if (event) {
                    businessGame.eventHistory.push(new GameEvent({
                        ...event,
                        remainingTurns: event.duration,
                        triggeredTurn: businessGame.turn
                    }));
                }
            }
        };
    </script>
</body>
</html>